
hello how are you??

## #################################################
## #################################################
## #################################################
##  Inference: HW6
## #################################################
## #################################################'
## #################################################

#######################################################
setwd("/Users/jyerxa/Desktop/Frederica")
getwd()

## ##################################
##  clear workspace
## ##################################
rm(list=ls())
ls()

## ##################################
square = function(vec,mn){
	sVec=c(0,0,0,0,0,0,0,0,0,0)
	for(i in 1:length(vec)){
		sqsum = (vec[i]-mn)^2
		sVec[i] = sqsum
	}
	return(sum(sVec))
}

## ##################################

## ##################################
x1 = c(15,26,20,20,29,28,21,26)
x2=c(19,15,10,26,11,20,13,15,18)
x3=c(22,26,24,26,15,17,24)

xn=c(x1,x2,x3)

## ##################################
square(x1,mean(x1))
square(x2,mean(x2))
square(x3,mean(x3))

square(xn,mean(xn))

## ##################################
xa=c(30.5,32.4,27.2,26.3,25.1,38.2,30.3,33.7)
xb=c(48.3,42.1,43.5,40.6,38.6,32.1,41.6,38.8)
xc=c(79.2,84.7,85,88.2,76.3,83.1,92.6,88.5)
xd=c(51.6,59.4,57.3,59,58.7,68.1,64.8,55.5)
xe=c(79,85.3,86.2,82,87.2,81.7,93.5,89.1)

xn=c(xa,xb,xc,xd,xe)


square(xa,mean(xa))
square(xb,mean(xb))
square(xc,mean(xc))
square(xd,mean(xd))
square(xe,mean(xe))

square(xn,mean(xn))

## ##################################
x1=c(261.1,186.2,239.1,243.3,296.8,270.5)
x2=c(221.9,188.7,167.6,224.9,178.8,147.9)
x3=c(201.4,146.1,96.8,173.9,280.8,100.3)
x4=c(600.9,301.2,608.9,283.3,193.3,159.4)
x5=c(160.6,135.0,455.1,402.3,457.9,559.6)

xn=c(x1,x2,x3,x4,x5)


m1=median(x1)
m2=median(x2)
m3=median(x3)
m4=median(x4)
m5=median(x5)

mn=median(xn)


square(x1,median(xn))
square(x2,median(xn))
square(x3,median(xn))
square(x4,median(xn))
square(x5,median(xn))

square(xn,median(xn))
## END PROBLEM 2################################################


## BEGIN PROBLEM 3################################################
## #################################################
# Kruskal Wallis
## #################################################

## #################################################
# Kruskal Wallis function
## #################################################
kwRank = function(rankVec){
	sumRankVec=c(0,0,0,0,0)
	sumRankLoc=0
	iteration = 0
	sumNum=0

	for(i in 1:30){
		sumNum = sumNum+rankVec[i]
		iteration = iteration +1
		
		if(iteration==6){
			sumRankLoc=sumRankLoc+1
			sumRankVec[sumRankLoc]=sumNum
			iteration = 0
			sumNum=0
		}
	}
	return(sumRankVec)
}

k1=c(261.1 ,186.2,239.1 ,  243.3, 296.8,270.5)
k2 = c(221.9 ,188.7, 167.6, 224.9 ,178.8,147.9)
k3=c(201.4 ,146.1,96.8,173.9, 280.8,100.3 )
k4=c(600.9 ,301.2, 608.9 ,283.3,193.3,159.4)
k5=c(160.6 , 135.0,455.1,402.3,457.9,559.6)
kn=c(k1,k2,k3,k4,k5)
rankKN = rank(kn, na.last = TRUE,ties.method = c("average"))
     
kwRank(rankKN) 
# confirm with R package        
kruskal.test(list(k1,k2,k3,k4,k5))     
## END PROBLEM 3################################################





## #################################################
## #################################################
## #################################################
##  END Inference: HW 5
## #################################################
## #################################################'
## #################################################


